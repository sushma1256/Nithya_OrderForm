<!-- Code Generated by Sidekick is for learning and experimentation purposes only. -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Order Form Annapurna Seeds</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        body { font-family: Arial,sans-serif; margin: 12px; }
        .form-row { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 12px;}
        .form-col { flex: 1 1 300px; min-width: 260px; }
        input, select, textarea, button {
            width: 100%;
            padding: 18px 12px;
            margin-top: 6px;
            margin-bottom: 12px;
            font-size: 1.2rem;
            box-sizing: border-box;
            border-radius: 7px;
            border: 1.5px solid #339EE6;
        }
        input[type="text"], input[type="date"], select, textarea {
            min-height: 45px;
        }
        label { font-weight: 500; font-size: 1.1em; }
        button {
            background-color: #2d7abd;
            color: #fff;
            border:none;
            font-size:1.2rem;
            padding:15px 0;
            border-radius:7px;
            cursor:pointer;
            margin-bottom: 12px;
        }
        h1, h2 {
            margin: 0.5em 0 0.2em 0;
            text-align: center;
        }
        .heading-bar {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 12px;
        }
        .drop-block {
            margin-bottom: 36px; /* Extra space between loadings */
        }
        table {
            width: 100%;
            margin: 20px 0 36px 0;
            border: 2px solid #000;
            border-collapse: collapse;
        }
        th, td {
            padding: 10px;
            text-align: left;
            font-size:1.1em;
            border: 2px solid #000;
        }
        th { background-color: #f0f0f0; }
        @media (max-width: 600px) {
            body { font-size: 1.1em; }
            .form-row { flex-direction: column; gap: 0;}
            .form-col { min-width: unset; }
            input, select, textarea, button { font-size: 1.2em; padding: 18px 10px; min-height: 45px; }
            h1, h2 { font-size: 1.5em; }
        }
    </style>
</head>
<body>
    <div class="heading-bar">
        <h1>Annapurna Seeds</h1>
        <h2>ORDER FORM</h2>
    </div>
    <br/>

    <div class="form-row">
        <div class="form-col">
            <label><b>Company Name :</b></label> <div style="font-size:1.1em;">TIYASA AGRO PRODUCT PVT LTD</div>
            <label><b>Address:</b></label> <div style="font-size:1.1em;">Amodpur, MEDINIPUR, West Begal 721126</div>
            <label><b>GST No:</b></label> <div style="font-size:1.1em;">19AAJCT6448D1Z1</div>
            <label><b>State:</b></label> <div style="font-size:1.1em;">West Bengal</div>
        </div>
        <div class="form-col">
            <label for="date"><b>Date:</b></label>
            <input type="date" id="date">
        </div>
        <div class="form-col">
            <label for="orderNo"><b>TWB Order No:</b></label>
            <input type="text" id="orderNo" placeholder="Enter order No (Prefix with TWB)">
        </div>
    </div>

    <span id="dropSelectorBlock">
        <b><label for="templateCount"><b>Select Number of loadings (1-3):</b></label></b>
        <select id="templateCount">
            <option value="">-- Select --</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
        </select>
    </span>
    <div id="dropsContainer" style="min-height:40px;"></div>
    <br />

    <label for="Note"><b>Note:</b></label>
    <input type="text" id="Note" placeholder="Enter Note">
    <br />
    <label for="signature"><b>Signature:</b></label>
    <input type="text" id="signature" placeholder="Enter Signature">
    <br />

    <button id="downloadBtn" onclick="downloadAsHTML()">Download as HTML Table</button>
    <br/>
    <div style="color: #b00; font-size: 1em;">
        Open the downloaded file in your mobile browser, Google Docs, or copy-paste into Word.
    </div>

    <script>
    // Code Generated by Sidekick is for learning and experimentation purposes only.
    document.getElementById("templateCount").addEventListener("change", generateTemplates);

    function generateRows(dropIndex) {
        let table = `<table>
            <tr>
                <th>S. No</th>
                <th>Variety</th>
                <th>Packing Size</th>
                <th>Required Quantity</th>
            </tr>`;
        for (let i = 1; i <= 7; i++) {
            table += `<tr>
                <td>${i}</td>
                <td><input type="text" name="variety_${dropIndex}_${i}" placeholder="Variety" style="min-width:120px;min-height:40px;font-size:1.1em;padding:12px;border:2px solid #000;"></td>
                <td><input type="text" name="pack_${dropIndex}_${i}" placeholder="Packing Size" style="min-width:120px;min-height:40px;font-size:1.1em;padding:12px;border:2px solid #000;"></td>
                <td><input type="text" name="qty_${dropIndex}_${i}" placeholder="Required Quantity" style="min-width:120px;min-height:40px;font-size:1.1em;padding:12px;border:2px solid #000;"></td>
            </tr>`;
        }
        table += `</table>`;
        return table;
    }

    function generateTemplates() {
        const count = parseInt(document.getElementById("templateCount").value);
        const container = document.getElementById("dropsContainer");
        container.innerHTML = "";
        if (!count || count < 1 || count > 3) {
            container.innerHTML = "<span style='color:red;'>Please select how many loadings.</span>";
            return;
        }
        for (let i = 1; i <= count; i++) {
            container.innerHTML += `
                <div class="drop-block">
                    <h2 style="text-align:center;">Loading ${i}</h2>
                    <div class="form-col">
                        <label for="Party_Name_${i}">Party Name:</label>
                        <input type="text" id="Party_Name_${i}" placeholder="Enter Party Name">
                    </div>
                    <div class="form-col">
                        <label for="delivery_${i}">Delivery Address:</label>
                        <input type="text" id="delivery_${i}" placeholder="Enter Delivery Address">
                    </div>
                    <div class="form-col">
                        <label for="phone_${i}">Consignee Phone Number:</label>
                        <input type="text" id="phone_${i}" placeholder="Enter Phone Number">
                    </div>
                    <div class="form-col">
                        <label for="gst_${i}">GST Number:</label>
                        <input type="text" id="gst_${i}" placeholder="Enter GST Number">
                    </div>
                    <div class="form-col">
                        <label for="license_${i}">Seed license number:</label>
                        <input type="text" id="license_${i}" placeholder="Enter Seed license number">
                    </div>
                    <br />
                    ${generateRows(i)}
                    <div class="form-col">
                        <br /><label for="otherreq_${i}">Any Other Requirements/ Note:</label>
                        <input type="text" id="otherreq_${i}" placeholder="Enter Any Other Requirements/ Note">
                    </div>
                </div>
                <br>
            `;
        }
    }

    function downloadAsHTML() {
        var html = `<html>
        <head>
            <meta charset="UTF-8">
            <title>Order Form Export</title>
            <style>
            body{font-family:Arial,sans-serif;}
            h1, h2{text-align:center;}
            table{width:100%;margin:20px 0 36px 0;border:2px solid #000;border-collapse:collapse;}
            th, td{padding:10px;font-size:1.1em;border:2px solid #000;}
            th{background:#f0f0f0;}
            .loading-title{margin-top:36px;margin-bottom:12px;text-align:center;font-size:1.15em;}
            </style>
        </head>
        <body>
        <h1>Annapurna Seeds</h1>
        <h2>ORDER FORM</h2>
        <hr style="margin: 12px 0 28px 0;">
        <table>
            <tr><th>Company Name</th><td>TIYASA AGRO PRODUCT PVT LTD</td></tr>
            <tr><th>Address</th><td>Amodpur, MEDINIPUR, West Begal 721126</td></tr>
            <tr><th>GST No</th><td>19AAJCT6448D1Z1</td></tr>
            <tr><th>State</th><td>West Bengal</td></tr>
            <tr><th>Date</th><td>${document.getElementById('date').value}</td></tr>
            <tr><th>Order No</th><td>${document.getElementById('orderNo').value}</td></tr>
        </table>
        <br>`;

        var count = parseInt(document.getElementById("templateCount").value) || 1;
        for (var i = 1; i <= count; i++) {
            html += `<div class="loading-title"><h2>Loading ${i}</h2></div>
            <table>
            <tr><th>Party Name</th><td>${document.getElementById('Party_Name_'+i)?.value || ""}</td></tr>
            <tr><th>Delivery Address</th><td>${document.getElementById('delivery_'+i)?.value || ""}</td></tr>
            <tr><th>Consignee Phone Number</th><td>${document.getElementById('phone_'+i)?.value || ""}</td></tr>
            <tr><th>GST Number</th><td>${document.getElementById('gst_'+i)?.value || ""}</td></tr>
            <tr><th>Seed license number</th><td>${document.getElementById('license_'+i)?.value || ""}</td></tr>
            </table>
            <table>
                <tr>
                    <th>S.No</th>
                    <th>Variety</th>
                    <th>Packing Size</th>
                    <th>Required Quantity</th>
                </tr>`;
            for (var j = 1; j <= 7; j++) {
                html += `<tr>
                    <td>${j}</td>
                    <td>${document.getElementsByName("variety_"+i+"_"+j)[0]?.value || ""}</td>
                    <td>${document.getElementsByName("pack_"+i+"_"+j)[0]?.value || ""}</td>
                    <td>${document.getElementsByName("qty_"+i+"_"+j)[0]?.value || ""}</td>
                </tr>`;
            }
            html += '</table>';
            html += `<table><tr><th>Any Other Requirements/ Note</th><td>${document.getElementById('otherreq_'+i)?.value || ""}</td></tr></table><br>`;
        }
        html += `<table>
        <tr><th>Note</th><td>${document.getElementById('Note').value || ""}</td></tr>
        <tr><th>Signature</th><td>${document.getElementById('signature').value || ""}</td></tr>
        </table>
        </body></html>`;

        var blob = new Blob([html], {type: 'text/html'});
        var link = document.createElement('a');
        link.href = window.URL.createObjectURL(blob);
        link.download = 'OrderForm.html';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    }
    </script>
</body>
</html>
