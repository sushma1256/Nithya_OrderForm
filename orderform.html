<!-- Code Generated by Sidekick is for learning and experimentation purposes only. -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Order Form Annapurna Seeds</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        body { font-family: Arial,sans-serif; margin: 12px; }
        .form-row { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 12px;}
        .form-col { flex: 1 1 250px; min-width: 220px; }
        input, select, textarea, button {
            width: 100%; padding: 10px; margin-top: 4px; margin-bottom: 8px; font-size: 1rem; box-sizing: border-box;
        }
        label { font-weight: 500; }
        button { background-color: #2d7abd; color: #fff; border:none; font-size:1.1rem; padding:10px 0; border-radius:6px; cursor:pointer;}
        h1, h2 { margin: 0.5em 0 0.2em 0; }
        center { display: block; }
        table, th, td { border:1px solid #000; border-collapse:collapse; }
        th, td { padding: 6px; text-align: left; }
        th { background-color: #f0f0f0; }
        @media (max-width: 600px) {
            body { font-size: 1em; }
            .form-row { flex-direction: column; gap: 0;}
            .form-col { min-width: unset; }
            input, select, textarea, button { font-size: 1.1em; }
            h1, h2 { font-size: 1.4em; }
        }
    </style>
</head>
<body>
    <center><h1>Annapurna Seeds</h1></center>
    <center><h2>ORDER FORM</h2></center>
    <br/>
    <div class="form-row">
        <div class="form-col">
            <label><b>Company Name :</b></label> <div>Tiyasa Agro PVT.LTD</div>
            <label><b>Address:</b></label> <div>Amodpur, West Begal 721126</div>
            <label><b>GST No:</b></label> <div>19AAJCT6448D1Z1</div>
            <label><b>State:</b></label> <div>West Bengal</div>
        </div>
        <div class="form-col">
            <label for="date"><b>Date:</b></label>
            <input type="date" id="date">
        </div>
        <div class="form-col">
            <label for="orderNo"><b>TWB Order No:</b></label>
            <input type="text" id="orderNo" placeholder="Enter order No (Prefix with TWB)">
        </div>
    </div>
    <span id="dropSelectorBlock">
        <b><label for="templateCount"><b>Select Number of loadings (1-3):</b></label></b>
        <select id="templateCount">
            <option value="">-- Select --</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
        </select>
    </span>
    <div id="dropsContainer" style="min-height:40px;"></div>
    <br />
    <label for="Note"><b>Note:</b></label>
    <input type="text" id="Note" placeholder="Enter Note">
    <br />
    <label for="signature"><b>Signature:</b></label>
    <input type="text" id="signature" placeholder="Enter Signature">

    <br /><button id="downloadBtn" onclick="downloadWord()">Download as Word</button>

<script>
// Code Generated by Sidekick is for learning and experimentation purposes only.
document.getElementById("templateCount").addEventListener("change", generateTemplates);

function generateRows(dropIndex) {
    let table = `<table style="width:100%;border-collapse:collapse;margin-top:12px;">
        <tr>
            <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">S. No</th>
            <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">Variety</th>
            <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">Packing Size</th>
            <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">Required Quantity</th>
        </tr>
    `;
    for (let i = 1; i <= 7; i++) {
        table += `<tr>
            <td style="border:1px solid #000;padding:6px;">${i}</td>
            <td style="border:1px solid #000;padding:6px;"><input type="text" name="variety_${dropIndex}_${i}" placeholder="Variety"></td>
            <td style="border:1px solid #000;padding:6px;"><input type="text" name="pack_${dropIndex}_${i}" placeholder="Packing Size"></td>
            <td style="border:1px solid #000;padding:6px;"><input type="text" name="qty_${dropIndex}_${i}" placeholder="Required Quantity"></td>
        </tr>`;
    }
    table += `</table>`;
    return table;
}

function generateTemplates() {
    const count = parseInt(document.getElementById("templateCount").value);
    const container = document.getElementById("dropsContainer");
    container.innerHTML = "";
    if (!count || count < 1 || count > 3) {
        container.innerHTML = "<span style='color:red;'>Please select how many loadings.</span>";
        return;
    }
    for (let i = 1; i <= count; i++) {
        container.innerHTML += `
            <div class="drop-block">
                <h2>Drop ${i}</h2>
                <div class="form-col">
                    <label for="Party_Name_${i}">Party Name:</label>
                    <input type="text" id="Party_Name_${i}" placeholder="Enter Party Name">
                </div>
                <div class="form-col">
                    <label for="delivery_${i}">Delivery Address:</label>
                    <input type="text" id="delivery_${i}" placeholder="Enter Delivery Address">
                </div>
                <div class="form-col">
                    <label for="phone_${i}">Consignee Phone Number:</label>
                    <input type="text" id="phone_${i}" placeholder="Enter Phone Number">
                </div>
                <br />
                ${generateRows(i)}
                <div class="form-col">
                    <br /><label for="otherreq_${i}">Any Other Requirements/ Note:</label>
                    <input type="text" id="otherreq_${i}" placeholder="Enter Any Other Requirements/ Note">
                </div>
            </div>
            <br>
        `;
    }
}

function downloadWord() {
    const count = parseInt(document.getElementById("templateCount").value);
    if (!count || count < 1 || count > 3) {
        alert("Please select how many loadings (1-3) before downloading.");
        return;
    }

    // 1. Start with company/header
    let htmlContent = `
        <center><h1>Annapurna Seeds</h1></center>
        <center><h2>ORDER FORM</h2></center><br/>
        <div class="form-row">
            <div class="form-col">
                <label><b>Company Name :</b></label> <div>Tiyasa Agro PVT.LTD</div>
                <label><b>Address:</b></label> <div>Amodpur, West Begal 721126</div>
                <label><b>GST No:</b></label> <div>19AAJCT6448D1Z1</div>
                <label><b>State:</b></label> <div>West Bengal</div>
            </div>
            <div class="form-col">
                <label><b>Date:</b></label>
                <span>${document.getElementById("date").value || ""}</span>
            </div>
            <div class="form-col">
                <label><b>Order No:</b></label>
                <span>${document.getElementById("orderNo").value || ""}</span>
            </div>
        </div>
    `;

    // 2. Insert drop blocks (tables) next
    for (let i = 1; i <= count; i++) {
        htmlContent += `
            <div class="drop-block">
                <h2>Drop ${i}</h2>
                <div class="form-col">
                    <label>Party Name:</label>
                    <span>${document.getElementById("Party_Name_" + i)?.value || ""}</span>
                </div>
                <div class="form-col">
                    <label>Delivery Address:</label>
                    <span>${document.getElementById("delivery_" + i)?.value || ""}</span>
                </div>
                <div class="form-col">
                    <label>Consignee Phone Number:</label>
                    <span>${document.getElementById("phone_" + i)?.value || ""}</span>
                </div>
                <br />
                <table style="width:100%;border-collapse:collapse;margin-top:12px;">
                    <tr>
                        <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">S. No</th>
                        <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">Variety</th>
                        <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">Packing Size</th>
                        <th style="border:1px solid #000;padding:6px;background:#f0f0f0;">Required Quantity</th>
                    </tr>
        `;
        for (let j = 1; j <= 7; j++) {
            htmlContent += `
                <tr>
                    <td style="border:1px solid #000;padding:6px;">${j}</td>
                    <td style="border:1px solid #000;padding:6px;">${document.getElementsByName(`variety_${i}_${j}`)[0]?.value || ""}</td>
                    <td style="border:1px solid #000;padding:6px;">${document.getElementsByName(`pack_${i}_${j}`)[0]?.value || ""}</td>
                    <td style="border:1px solid #000;padding:6px;">${document.getElementsByName(`qty_${i}_${j}`)[0]?.value || ""}</td>
                </tr>
            `;
        }
        htmlContent += `</table>
            <div class="form-col">
                <br /><label>Any Other Requirements/ Note:</label>
                <span>${document.getElementById("otherreq_" + i)?.value || ""}</span>
            </div>
            </div>
            <br>
        `;
    }

    // 3. Note & Signature at the end
    htmlContent += `
        <br/>
        <div class="form-row">
            <div class="form-col">
                <b>Note:</b> ${document.getElementById("Note").value || ""}
            </div>
            <div class="form-col">
                <b>Signature:</b> ${document.getElementById("signature").value || ""}
            </div>
        </div>
    `;

    let header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
        "xmlns:w='urn:schemas-microsoft-com:office:word' " +
        "xmlns='http://www.w3.org/TR/REC-html40'>" +
        "<head><meta charset='utf-8'><title>Export HTML To Doc</title>" +
        "<style>table, th, td { border: 1px solid #000; border-collapse: collapse; padding: 6px; } th { background: #f0f0f0; }</style></head><body>";
    let footer = "</body></html>";

    let sourceHTML = header + htmlContent + footer;
    let url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
    let downloadLink = document.createElement("a");
    document.body.appendChild(downloadLink);
    downloadLink.href = url;
    downloadLink.download = 'OrderForm.doc';
    downloadLink.click();
    document.body.removeChild(downloadLink);
}
</script>
</body>
</html>
