<!-- Code Generated by Sidekick is for learning and experimentation purposes only. -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Order Form Annapurna Seeds</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        body { font-family: Arial,sans-serif; margin: 12px; }
        .form-row { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 12px;}
        .form-col { flex: 1 1 250px; min-width: 220px; }
        input, select, textarea, button { 
            width: 100%; padding: 10px; margin-top: 4px; margin-bottom: 8px; font-size: 1rem; box-sizing: border-box;
        }
        label { font-weight: 500; }
        table { width: 100%; border-collapse: collapse; margin-top: 12px; }
        th, td { border:1px solid #000; padding:6px; text-align:left; }
        th { background-color: #f0f0f0; }
        button { background-color: #2d7abd; color: #fff; border:none; font-size:1.1rem; padding:10px 0; border-radius:6px; cursor:pointer;}
        h1, h2 { margin: 0.5em 0 0.2em 0; }
        center { display: block; }
        
        /* Responsive table container for mobile: */
        .table-responsive { 
            width: 100%; 
            overflow-x: auto; 
        }

        @media (max-width: 600px) {
            body { font-size: 1em; }
            .form-row { flex-direction: column; gap: 0;}
            .form-col { min-width: unset; }
            input, select, textarea, button { font-size: 1.1em; }
            /* Make all headers and blocks more spaced for touch */
            h1, h2 { font-size: 1.4em; }
            .table-responsive { margin-bottom: 1em;}
        }
    </style>
</head>
<body>
    <center><h1>Annapurna Seeds</h1></center>
    <center><h2>ORDER FORM</h2></center>
    <br/>

    <div class="form-row">
        <div class="form-col">
            <label><b>Company Name :</b></label> <div>Tiyasa Agro PVT.LTD</div>
            <label><b>Address:</b></label> <div>Amodpur, West Begal 721126</div>
            <label><b>GST No:</b></label> <div>19AAJCT6448D1Z1</div>
            <label><b>State:</b></label> <div>West Bengal</div>
        </div>
        <div class="form-col">
            <label for="date"><b>Date:</b></label>
            <input type="date" id="date">
        </div>
        <div class="form-col">
            <label for="orderNo"><b>Order No:</b></label>
            <input type="text" id="orderNo" placeholder="Enter order No (Prefix with TW)">
        </div>
    </div>

    <span id="dropSelectorBlock">
        <b><label for="templateCount"><b>Select Number of loadings (1-3):</b></label></b>
        <select id="templateCount">
            <option value="">-- Select --</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
        </select>
    </span>
    <div id="dropsContainer" style="min-height:40px;"></div>

    <label for="Note"><b>Note:</b></label>
    <input type="text" id="Note" placeholder="Enter Note">
    <br />
    <label for="signature"><b>Signature:</b></label>
    <input type="text" id="signature" placeholder="Enter Signature">

    <button id="downloadBtn" onclick="downloadWord()">Download as Word</button>

    <script>
        document.getElementById("templateCount").addEventListener("change", generateTemplates);

        function generateRows() {
            // Put the table in a scrollable div for mobile
            let table = `<div class="table-responsive"><table>
                <tr>
                    <th>S. No</th>
                    <th>Packing Size</th>
                    <th>Required Quantity</th>
                </tr>`;
            for (let i = 1; i <= 7; i++) {
                table += `
                <tr>
                    <td>${i}</td>
                    <td><input type="text" name="pack_${i}" placeholder="Packing Size"></td>
                    <td><input type="text" name="qty_${i}" placeholder="Required Quantity"></td>
                </tr>`;
            }
            table += `</table></div>`;
            return table;
        }

        function generateTemplates() {
            const count = parseInt(document.getElementById("templateCount").value);
            const container = document.getElementById("dropsContainer");
            container.innerHTML = "";
            if (!count || count < 1 || count > 3) {
                container.innerHTML = "<span style='color:red;'>Please select how many loadings.</span>";
                return;
            }
            for (let i = 1; i <= count; i++) {
                container.innerHTML += `
                    <div class="drop-block">
                        <h2>Drop ${i}</h2>
                        <div class="form-col">
                            <label for="Party_Name_${i}">Party Name:</label>
                            <input type="text" id="Party_Name_${i}" placeholder="Enter Party Name">
                        </div>
                        <div class="form-col">
                            <label for="delivery_${i}">Delivery Address:</label>
                            <input type="text" id="delivery_${i}" placeholder="Enter Delivery Address">
                        </div>
                        <div class="form-col">
                            <label for="phone_${i}">Consignee Phone Number:</label>
                            <input type="text" id="phone_${i}" placeholder="Enter Phone Number">
                        </div>
                        <br /> ${generateRows()}
                        <div class="form-col">
                            <br /><label for="otherreq_${i}">Any Other Requirements/ Note:</label>
                            <input type="text" id="otherreq_${i}" placeholder="Enter Any Other Requirements/ Note">
                        </div>
                    </div>
                    <br>`;
            }
        }

        function downloadWord() {
            var downloadBtn = document.getElementById('downloadBtn');
            downloadBtn.style.display = 'none';

            var clone = document.body.cloneNode(true);
            downloadBtn.style.display = '';
            var cloneDownloadBtn = clone.querySelector('#downloadBtn');
            if (cloneDownloadBtn) cloneDownloadBtn.parentNode.removeChild(cloneDownloadBtn);

            var dropSelectorBlock = clone.querySelector('#dropSelectorBlock');
            if (dropSelectorBlock) dropSelectorBlock.parentNode.removeChild(dropSelectorBlock);

            var mobileTableCSS = clone.querySelector('style#mobileTableCSS');
            if (mobileTableCSS) mobileTableCSS.parentNode.removeChild(mobileTableCSS);

            var inputs = clone.querySelectorAll('input');
            inputs.forEach(function(input) {
                var value = input.value || '';
                var span = document.createElement('span');
                if (input.type === 'date' && value) {
                    span.textContent = new Date(value).toLocaleDateString();
                } else {
                    span.textContent = value;
                }
                input.parentNode.replaceChild(span, input);
            });

            var textareas = clone.querySelectorAll('textarea');
            textareas.forEach(function(textarea) {
                var value = textarea.value || '';
                var span = document.createElement('span');
                span.textContent = value;
                textarea.parentNode.replaceChild(span, textarea);
            });

            var selects = clone.querySelectorAll('select');
            selects.forEach(function(select) {
                var selectedOption = select.options[select.selectedIndex];
                var span = document.createElement('span');
                if (selectedOption && selectedOption.value !== "") {
                    span.textContent = selectedOption.text;
                } else {
                    span.textContent = "";
                }
                select.parentNode.replaceChild(span, select);
            });

            var header = "<html xmlns:o='urn:schemas-microsoft-com:office:office' " +
                "xmlns:w='urn:schemas-microsoft-com:office:word' " +
                "xmlns='http://www.w3.org/TR/REC-html40'>" +
                "<head><meta charset='utf-8'><title>Export HTML To Doc</title></head><body>";
            var footer = "</body></html>";
            var content = clone.innerHTML;
            var sourceHTML = header + content + footer;
            var url = 'data:application/vnd.ms-word;charset=utf-8,' + encodeURIComponent(sourceHTML);
            var downloadLink = document.createElement("a");
            document.body.appendChild(downloadLink);
            downloadLink.href = url;
            downloadLink.download = 'OrderForm.doc';
            downloadLink.click();
            document.body.removeChild(downloadLink);
        }
    </script>
</body>
</html>
